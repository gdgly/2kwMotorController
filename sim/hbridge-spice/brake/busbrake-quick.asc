Version 4
SHEET 1 1876 1568
WIRE 816 736 784 736
WIRE 832 736 816 736
WIRE 992 736 960 736
WIRE 1008 736 992 736
WIRE -1136 752 -1344 752
WIRE -768 752 -1136 752
WIRE -608 752 -768 752
WIRE -304 752 -608 752
WIRE 784 752 784 736
WIRE 960 752 960 736
WIRE 336 768 320 768
WIRE 560 768 544 768
WIRE -768 784 -768 752
WIRE -304 800 -304 752
WIRE 336 800 320 800
WIRE 560 800 544 800
WIRE 336 832 320 832
WIRE 560 832 544 832
WIRE 784 848 784 832
WIRE 960 848 960 832
WIRE 336 864 320 864
WIRE 560 880 544 880
WIRE -304 896 -304 880
WIRE 560 912 544 912
WIRE 816 928 784 928
WIRE 832 928 816 928
WIRE 992 928 960 928
WIRE 1008 928 992 928
WIRE -768 944 -768 864
WIRE -768 944 -944 944
WIRE -592 944 -768 944
WIRE 560 944 544 944
WIRE 784 944 784 928
WIRE 960 944 960 928
WIRE -944 976 -944 944
WIRE -592 976 -592 944
WIRE -192 976 -256 976
WIRE -1136 992 -1136 752
WIRE -192 992 -192 976
WIRE -112 1008 -144 1008
WIRE 80 1024 -48 1024
WIRE 16 1040 -48 1040
WIRE 784 1040 784 1024
WIRE 960 1040 960 1024
WIRE -1344 1056 -1344 752
WIRE -992 1056 -1040 1056
WIRE -496 1056 -544 1056
WIRE -144 1072 -144 1056
WIRE -144 1072 -192 1072
WIRE -944 1088 -944 1072
WIRE -832 1088 -944 1088
WIRE -592 1088 -592 1072
WIRE -592 1088 -640 1088
WIRE -192 1088 -192 1072
WIRE 16 1088 16 1040
WIRE -944 1104 -944 1088
WIRE -592 1104 -592 1088
WIRE 272 1120 240 1120
WIRE 304 1120 272 1120
WIRE 416 1120 384 1120
WIRE 560 1120 496 1120
WIRE 560 1136 560 1120
WIRE -992 1184 -1040 1184
WIRE -496 1184 -544 1184
WIRE 16 1184 16 1168
WIRE -1344 1232 -1344 1136
WIRE -1296 1232 -1344 1232
WIRE -1136 1232 -1136 1056
WIRE -1136 1232 -1200 1232
WIRE -944 1232 -944 1200
WIRE -944 1232 -1136 1232
WIRE -768 1232 -944 1232
WIRE -592 1232 -592 1200
WIRE -592 1232 -768 1232
WIRE -304 1232 -304 992
WIRE -304 1232 -592 1232
WIRE 272 1232 240 1232
WIRE 560 1232 560 1216
WIRE 560 1232 272 1232
WIRE -768 1296 -768 1232
WIRE -1216 1312 -1216 1280
WIRE -176 1312 -208 1312
WIRE -64 1312 -96 1312
WIRE -16 1312 -64 1312
WIRE 80 1312 80 1024
WIRE 80 1312 48 1312
WIRE -64 1344 -64 1312
WIRE -1216 1408 -1216 1392
WIRE -64 1424 -64 1408
FLAG 816 736 Vduty
FLAG 784 848 0
FLAG 320 768 Vduty
FLAG 320 800 Vdir
FLAG 320 832 Vbrake
FLAG 320 864 Vmode
FLAG 560 800 M+
FLAG 560 912 M-
FLAG 992 736 Vdir
FLAG 960 848 0
FLAG 816 928 Vbrake
FLAG 784 1040 0
FLAG 992 928 Vmode
FLAG 960 1040 0
FLAG -640 1088 M-
FLAG -768 1296 0
FLAG -1040 1056 HO1
FLAG -1040 1184 LO1
FLAG -496 1056 HO2
FLAG -496 1184 LO2
FLAG 560 768 HO1
FLAG 560 832 LO1
FLAG 560 880 HO2
FLAG 560 944 LO2
FLAG -608 752 Vbus
FLAG -832 1088 M+
FLAG 272 1120 M+
FLAG 272 1232 M-
FLAG -1216 1408 0
FLAG -192 1088 0
FLAG 16 1184 0
FLAG -208 1312 Vbus
FLAG -64 1424 0
SYMBOL voltage 784 736 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -136 147 Left 2
SYMATTR Value PWL(0 0.42 {t_drive} 0.98 {t_drive + 0.1m} 0.21)
SYMATTR InstName Vduty
SYMBOL voltage 960 736 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName Vdir
SYMATTR Value 0
SYMBOL voltage 960 928 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName Vmode
SYMATTR Value 1
SYMBOL voltage 784 928 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -47 94 Left 2
SYMATTR Value 0
SYMATTR InstName Vbrake
SYMBOL nmos -992 976 R0
WINDOW 3 59 59 Left 2
SYMATTR Value IPP100N08N3
SYMATTR InstName M1
SYMBOL nmos -992 1104 R0
SYMATTR InstName M2
SYMATTR Value IPP100N08N3
SYMBOL nmos -544 976 M0
SYMATTR InstName M3
SYMATTR Value IPP100N08N3
SYMBOL nmos -544 1104 M0
SYMATTR InstName M4
SYMATTR Value IPP100N08N3
SYMBOL voltage -1344 1040 R0
WINDOW 123 0 0 Left 2
WINDOW 39 27 128 Left 2
WINDOW 3 24 104 Left 2
SYMATTR SpiceLine Rser=2m
SYMATTR Value {Vbatt}
SYMATTR InstName Vbus
SYMBOL res 288 1136 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName Motor
SYMATTR Value 0.089
SYMBOL GateDriver 448 848 R0
SYMATTR InstName X1
SYMBOL cap -1120 992 M0
SYMATTR InstName C1
SYMATTR Value 2mF
SYMATTR SpiceLine Rser=100m
SYMBOL res -784 768 R0
SYMATTR InstName Rsense
SYMATTR Value 1µ
SYMBOL res -288 784 M0
SYMATTR InstName Rbrake
SYMATTR Value 1
SYMATTR SpiceLine pwr=200
SYMBOL nmos -256 896 M0
WINDOW 3 59 59 Left 2
SYMATTR Value IPP100N08N3
SYMATTR InstName M5
SYMBOL voltage -1216 1296 R0
WINDOW 3 -291 145 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PWL(0 10 {t_drive} 10 {t_drive + 0.1m} 0)
SYMATTR InstName Vbus_dis
SYMBOL e -192 976 M0
SYMATTR InstName E1
SYMATTR Value 10
SYMBOL Digital\\and -80 960 M0
SYMATTR InstName A1
SYMBOL voltage 16 1072 R0
WINDOW 3 -286 149 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PULSE(0 1 0 1n 1n 0e-6 50e-6)
SYMATTR InstName V4
SYMBOL nmos -1296 1280 R270
WINDOW 3 -3 -14 VLeft 2
WINDOW 0 24 -14 VLeft 2
SYMATTR Value IPP100N08N3
SYMATTR InstName M6
SYMBOL Digital\\schmtbuf -16 1248 R0
WINDOW 3 8 103 Left 2
SYMATTR Value Vt={Vbatt+1} Vh=0.5
SYMATTR InstName A3
SYMBOL res -80 1296 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 800
SYMBOL cap -48 1344 M0
SYMATTR InstName C2
SYMATTR Value 100n
SYMBOL voltage 560 1120 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName Vgen
SYMATTR Value 20
SYMBOL ind 400 1136 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 120µ
TEXT 840 1160 Left 2 !.tran {t_drive + 0.05}
TEXT 840 1192 Left 2 !.param t_drive=0.02
TEXT 840 1224 Left 2 !.param Vbatt=48V
TEXT 408 1040 Left 2 !.ic I(L1)=90A
